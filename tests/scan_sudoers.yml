---
- name: "Test scan_sudoers"
  hosts: "localhost"
  gather_facts: False
  collections:
    - john_westcott_iv.ansible_fact
  tasks:
    - name: "Scan Sudoers"
      scan_sudoers:
      become: True

    - name: "Display all sudoers data"
      debug:
        var: "sudoers"

    - name: "Scan Sudoers - no parsed data"
      scan_sudoers:
        output_parsed_configs: False
      become: True

    - name: "Display only sudoers raw configs"
      debug:
        var: "sudoers"

    - name: "Scan Sudoers - no raw configuration data"
      scan_sudoers:
        output_raw_configs: False
      become: True

    - name: "Display only sudoers parsed configs"
      debug:
        var: "sudoers"
